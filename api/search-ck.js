jQuery.fn.slowEach=function(e,t,n){function i(){n.call(e[r],r,e[r])!==!1&&++r<e.length&&setTimeout(i,t)}if(!e.length)return;var r=0;i()};javascripture.api.search={language:{english:javascripture.data.english,greek:javascripture.data.greek,hebrew:javascripture.data.hebrew},books:{english:["Genesis","Exodus","Leviticus","Numbers","Deuteronomy","Joshua","Judges","Ruth","1 Samuel","2 Samuel","1 Kings","2 Kings","1 Chronicles","2 Chronicles","Ezra","Nehemiah","Esther","Job","Psalm","Proverbs","Ecclesiastes","Song of Songs","Isaiah","Jeremiah","Lamentations","Ezekiel","Daniel","Hosea","Joel","Amos","Obadiah","Jonah","Micah","Nahum","Habakkuk","Zephaniah","Haggai","Zechariah","Malachi","Matthew","Mark","Luke","John","Acts","Romans","1 Corinthians","2 Corinthians","Galatians","Ephesians","Philippians","Colossians","1 Thessalonians","2 Thessalonians","1 Timothy","2 Timothy","Titus","Philemon","Hebrews","James","1 Peter","2 Peter","1 John","2 John","3 John","Jude","Revelation"],hebrew:["Genesis","Exodus","Leviticus","Numbers","Deuteronomy","Joshua","Judges","Ruth","1 Samuel","2 Samuel","1 Kings","2 Kings","1 Chronicles","2 Chronicles","Ezra","Nehemiah","Esther","Job","Psalm","Proverbs","Ecclesiastes","Song of Songs","Isaiah","Jeremiah","Lamentations","Ezekiel","Daniel","Hosea","Joel","Amos","Obadiah","Jonah","Micah","Nahum","Habakkuk","Zephaniah","Haggai","Zechariah","Malachi"],greek:["Matthew","Mark","Luke","John","Acts","Romans","1 Corinthians","2 Corinthians","Galatians","Ephesians","Philippians","Colossians","1 Thessalonians","2 Thessalonians","1 Timothy","2 Timothy","Titus","Philemon","Hebrews","James","1 Peter","2 Peter","1 John","2 John","3 John","Jude","Revelation"]},types:["word","lemma","morph"],results:{references:[],matches:{}},getReferences:function(e){var t=this;t.parameters=e;console.log(e);t.deferred=$.Deferred();this.lookForTerm();return t.deferred},doesDataMatchTerm:function(e,t,n,r){t=t.toLowerCase();n=n.toLowerCase();return t===n?!0:e!=="lemma"&&!r&&t.search(n)>-1?!0:!1},resetMatches:function(){this.results.matches={}},addReference:function(e,t,n){this.results.references.push({book:e,chapter:t+1,verse:n+1})},lookForTerm:function(){var e=this,t=e.parameters;"undefined"==typeof t.language&&(t.language=e.inferLanguage(t));var n=this.language[t.language];e.results.references=[];e.resetMatches();var r=this.books[t.language];if($("#searchSpeed").length>0&&$("#searchSpeed").val()>1){searchSpeed=$("#searchSpeed").val();jQuery.fn.slowEach(r,searchSpeed,function(t,i){e.searchInABook(n,i,t,r)})}else r.forEach(function(t,i){e.searchInABook(n,t,i,r)})},searchInABook:function(e,t,n,r){var i=this,s=i.parameters,o=e[t],u=0;for(var a in i.types){var f=i.types[a];termString=s[f];if(termString!==undefined&&termString!==""){var l=termString.split(" ");u+=l.length}}$(document).trigger("loading","searching "+t);o.forEach(function(e,n){s.range==="chapter"&&s.clusivity==="exclusive"&&i.resetMatches();e.forEach(function(e,r){s.range==="verse"&&s.clusivity==="exclusive"&&i.resetMatches();e.forEach(function(e,o){s.range==="word"&&s.clusivity==="exclusive"&&i.resetMatches();var a,f;i.types.forEach(function(o,u){f=s[o];if(i.areTheTermStringAndWordObjectAreGoodToSearch(f,e,u)){var a=f.split(" ");a.forEach(function(a,f){i.doesDataMatchTerm(o,e[u],a,s.strict)&&(s.clusivity==="exclusive"?i.results.matches[a]=!0:i.addReference(t,n,r))})}});if(s.clusivity==="exclusive"){a=0;$.each(i.results.matches,function(e,t){a++});if(a>0&&a>=u){i.addReference(t,n,r);i.resetMatches()}}})})});n===r.length-1&&i.deferred.resolve()},standarizeWordEndings:function(e){return e.replace(/ם/gi,"מ")},getTranslations:function(e){},inferLanguage:function(e){var t="english";e.lemma.substr(0,1)==="H"&&(t="hebrew");e.lemma.substr(0,1)==="G"&&(t="greek");return t},areTheTermStringAndWordObjectAreGoodToSearch:function(e,t,n){return e!==undefined&&e!==""&&t!==undefined&&typeof t[n]!="undefined"},countResults:function(){return this.results.references.length}};