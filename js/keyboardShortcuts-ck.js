/*global javascripture, console*/(function(e){"use strict";var t=!1,n=!1,r,i=!1;e(document).on("keydown",function(s){console.log(s.keyCode);if(s.keyCode===91||s.keyCode===17||s.keyCode===18)i=!0;e("input:focus").length!==0&&console.log(e("input:focus"));if(e("input:focus").length===0&&!i){27===s.keyCode&&e(".popup").popup("close");if(s.which>47&&s.which<58){var o=s.which-48,u=javascripture.modules.reference.getReferenceFromCurrentUrl();n&&(o=""+u.chapter+o);n=!0;clearTimeout(r);var a=bible.getBookId(u.book);bible.Data.verses[a-1][o-1]&&(window.location.hash="#book="+u.book+"&chapter="+o);r=setTimeout(function(){n===!0&&(n=!1)},1e3)}(s.keyCode===187||s.keyCode===61)&&e("#currentRef").next().length>0&&markReference(e("#currentRef").next());(s.keyCode===189||s.keyCode===173)&&e("#currentRef").prev().length>0&&markReference(e("#currentRef").prev());if(s.keyCode===18)t=!0;else{if(t){var f=e("#keyCode"+s.keyCode);if(f.length>0){s.preventDefault();e("#keyCode"+s.keyCode).click()}if(s.keyCode===14||s.keyCode===16||s.keyCode===45||s.keyCode===61)if(e("#results .collapsible-wrapper").length){var l=e("#results").find(".ui-btn-active"),c;if(s.keyCode===61||s.keyCode===14)c=l.closest("li").next().find("a");if(s.keyCode===45||s.keyCode===16)c=l.closest("li").prev().find("a");c.click();window.location=c.attr("href");c.closest("ol").scrollTo(c)}}t=!1}if(s.keyCode>64&&s.keyCode<91){e(".dock").css("top",0);e("#goToReference").val("").focus()}}});e(document).on("keyup",function(e){if(e.keyCode===91||e.keyCode===17||e.keyCode===18)i=!1})})(jQuery);